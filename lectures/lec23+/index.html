<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css" />
    <script src="js/three.min.js"></script>
    <script src="js/TrackballControls.js"></script>

    <title>Three.js Earth</title>
</head>
<body>
<div id="webgl"></div>
<script>

    // Created by Bjorn Sandvik - thematicmapping.org
    (function () {

        var webglEl = document.getElementById('webgl');

        var width  = window.innerWidth,
            height = window.innerHeight;

        // Earth params
        var radius   = 0.5,
            segments = 32,
            rotation = 6;

        var scene = new THREE.Scene();

        var camera = new THREE.PerspectiveCamera(45, width / height, 0.01, 1000);
        camera.position.z = 1.5;

        var renderer = new THREE.WebGLRenderer();
        renderer.setSize(width, height);

        scene.add(new THREE.AmbientLight("#red"));

        var light = new THREE.DirectionalLight("#444444", 1);
        light.position.set(5,3,5);
        scene.add(light);

        var sphere = createSphere(radius, segments);
        sphere.rotation.y = rotation;
        scene.add(sphere);

        var clouds = createClouds(radius, segments);
        clouds.rotation.y = rotation;
        scene.add(clouds);

        var stars = createStars(90, 64);
        scene.add(stars);

        var controls = new THREE.TrackballControls(camera);

        webglEl.appendChild(renderer.domElement);

        render();

        function render() {
            controls.update();
            sphere.rotation.y += 0.0005;
           clouds.rotation.y += 0.0005;
            requestAnimationFrame(render);
            renderer.render(scene, camera);
        }

        function createSphere(radius, segments) {
            return new THREE.Mesh(
                new THREE.SphereGeometry(radius, segments, segments),
                new THREE.MeshPhongMaterial({
                    map:         THREE.ImageUtils.loadTexture('assets/2_no_clouds.jpg'),
                    bumpMap:     THREE.ImageUtils.loadTexture('assets/elevation.jpg'),
                    bumpScale:   0.001,
                    specularMap: THREE.ImageUtils.loadTexture('assets/water.png'),
                    specular:    new THREE.Color("#444444")
                })
            );
        }

        function createClouds(radius, segments) {
            return new THREE.Mesh(
                new THREE.SphereGeometry(radius + 0.003, segments, segments),
                new THREE.MeshPhongMaterial({
                    map:         THREE.ImageUtils.loadTexture('assets/fair_clouds.png'),
                    transparent: true
                })
            );
        }

        function createStars(radius, segments) {
            return new THREE.Mesh(
                new THREE.SphereGeometry(radius, segments, segments),
                new THREE.MeshBasicMaterial({
                    map:  THREE.ImageUtils.loadTexture('assets/galaxy_starfield.png'),
                    side: THREE.BackSide
                })
            );
        }

    }());

</script>
</body>
</html>